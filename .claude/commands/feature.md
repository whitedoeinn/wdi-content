---
description: Full feature workflow with research, planning, implementation, and review (project)
---

# /feature - Compound Engineering Feature Workflow

## Flags

| Flag | Description |
|------|-------------|
| `--yes` | Auto-continue through phases (no pauses) |
| `--plan-only` | Stop after planning phase |
| `--skip-research` | Skip research agents, go straight to planning |

---

## Workflow Overview

```
Research → Plan → Work → Review → Compound
```

Each phase pauses for approval unless `--yes` is passed.

---

## Phase 1: Research (Smart Selection)

Skip if `--skip-research`.

### Step 1.1: Analyze Context

Determine which research agents to run based on:
- Feature description keywords
- Existing codebase patterns
- Files that will likely be modified

### Step 1.2: Select Research Agents

| Agent | Condition |
|-------|-----------|
| `repo-research-analyst` | Always - understands codebase structure |
| `git-history-analyzer` | Feature modifies existing code (keywords: modify, update, fix, change, refactor) |
| `framework-docs-researcher` | Project uses frameworks (check package.json for vite, alpine, tailwind, daisyui) |
| `best-practices-researcher` | Architectural decisions (keywords: architecture, pattern, design, system, structure) |

### Step 1.3: Run Research Agents

Run selected agents in parallel using Task tool:

```
subagent_type='compound-engineering:research:repo-research-analyst'
subagent_type='compound-engineering:research:git-history-analyzer'
subagent_type='compound-engineering:research:framework-docs-researcher'
subagent_type='compound-engineering:research:best-practices-researcher'
```

Prompt each agent with the feature description and ask for:
- Relevant existing patterns in the codebase
- Files that will need modification
- Constraints or considerations
- Recommended approaches

### Step 1.4: Synthesize Research

Combine agent outputs into a research summary:
- Key findings
- Existing patterns to follow
- Files to modify
- Constraints identified

### Step 1.5: Pause (unless --yes)

```
Research Phase Complete
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Agents run: [list agents]

Key findings:
• [finding 1]
• [finding 2]

Continue to planning? (y)es, (a)bort:
```

---

## Phase 2: Plan

### Step 2.1: Invoke Planning Workflow

Use Skill tool to invoke compound-engineering planning:

```
/compound-engineering:workflows:plan
```

Pass research context from Phase 1.

### Step 2.2: Generate Implementation Plan

The plan should include:
- **Requirements**: What the feature must do
- **Acceptance Criteria**: How to verify completion
- **Implementation Steps**: Ordered list of tasks
- **Files to Modify/Create**: Specific paths
- **Risks & Considerations**: What could go wrong

### Step 2.3: Create GitHub Issue

```bash
gh issue create --title "Feature: {feature-name}" --body "$(cat <<'EOF'
## Requirements
{requirements}

## Acceptance Criteria
- [ ] {criterion 1}
- [ ] {criterion 2}

## Implementation Plan
{steps}

## Files
- `{file1}` - {description}
- `{file2}` - {description}

## Risks
- {risk 1}

---
Generated by /feature workflow
EOF
)"
```

### Step 2.4: Save Local Plan

Write plan to `plans/{feature-slug}.md` for reference.

### Step 2.5: Pause (unless --yes)

```
Plan Phase Complete
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Created: Issue #{issue-number}
Plan: plans/{feature-slug}.md

Review the plan and continue to work? (y)es, (e)dit plan, (a)bort:
```

If `--plan-only`, stop here.

---

## Phase 3: Work

### Step 3.1: Create Feature Branch

```bash
git checkout -b feature/{feature-slug}
```

### Step 3.2: Invoke Work Workflow

Use Skill tool:

```
/compound-engineering:workflows:work
```

Pass the implementation plan from Phase 2.

### Step 3.3: Execute Implementation

For each implementation step:
1. Add to TodoWrite as `in_progress`
2. Implement the step
3. Mark as `completed`
4. Move to next step

### Step 3.4: Run Tests

```bash
npm test
npm run build
```

If tests fail, fix issues before continuing.

### Step 3.5: Pause (unless --yes)

```
Work Phase Complete
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Branch: feature/{feature-slug}
Commits: {count}
Tests: ✓ passing

Ready for review? (y)es, (c)ontinue working, (a)bort:
```

---

## Phase 4: Review

### Step 4.1: Invoke Review Workflow

Use Skill tool:

```
/compound-engineering:workflows:review
```

### Step 4.2: Run Review Agents

Run these review agents on the changes:

| Agent | Focus |
|-------|-------|
| `code-simplicity-reviewer` | YAGNI, over-engineering, unnecessary abstraction |
| `architecture-strategist` | Design patterns, consistency with codebase |
| `security-sentinel` | Security vulnerabilities, input validation |
| `performance-oracle` | Performance issues, inefficient patterns |

### Step 4.3: Present Findings

For each finding:
```
[Agent]: {issue description}

File: {file}:{line}
Severity: {low|medium|high}

(f)ix, (a)cknowledge, (s)kip:
```

- **fix**: Apply suggested fix
- **acknowledge**: Note the issue but continue
- **skip**: Ignore this finding

### Step 4.4: Pause (unless --yes)

```
Review Phase Complete
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Findings: {count} total
  ✓ Fixed: {fixed}
  ○ Acknowledged: {acknowledged}
  - Skipped: {skipped}

Merge and compound? (y)es, (r)eview again, (a)bort:
```

---

## Phase 5: Compound

### Step 5.1: Merge to Main

Option A - Direct merge (small features):
```bash
git checkout main
git pull
git merge --no-ff feature/{feature-slug} -m "Merge feature/{feature-slug}"
```

Option B - Create PR (larger features):
```bash
gh pr create --title "Feature: {feature-name}" --body "{plan-summary}"
```

### Step 5.2: Update Changelog

Invoke existing `/commit` workflow for changelog:

```
/commit --yes
```

This updates `docs/changelog.md` with the feature entry.

### Step 5.3: Invoke Compound Workflow

Use Skill tool:

```
/compound-engineering:workflows:compound
```

### Step 5.4: Document Learnings

Capture what was learned:
- Patterns that worked well
- Things to do differently
- New conventions to adopt

If significant learnings, update `CLAUDE.md` with new patterns.

### Step 5.5: Cleanup

```bash
git branch -d feature/{feature-slug}
git push origin --delete feature/{feature-slug}  # if pushed
```

### Step 5.6: Final Output

```
Feature Complete
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✓ Issue #{issue-number} closed
✓ Merged to main
✓ Changelog updated
✓ Learnings documented

Learnings:
• {learning 1}
• {learning 2}
```

---

## Examples

### Quick feature (auto-continue)

```
/feature --yes Add print button to expense form
```

Runs all phases automatically, only stopping on errors.

### Planning only

```
/feature --plan-only Implement user dashboard with analytics
```

Creates research summary, GitHub issue, and local plan, then stops.

### Skip research for known changes

```
/feature --skip-research Fix navigation styling on mobile
```

Skips research phase, goes straight to planning.

### Full interactive workflow

```
/feature Add dark mode toggle to settings

→ Research Phase
  Running: repo-research-analyst, framework-docs-researcher

  Key findings:
  • DaisyUI has built-in theme support via data-theme attribute
  • Alpine.js can persist theme preference to localStorage
  • Existing settings page at public/settings.html

  Continue to planning? [y]

→ Plan Phase
  Created: Issue #15 "Feature: Dark mode toggle"
  Plan: plans/dark-mode-toggle.md

  Requirements:
  • Toggle switch in settings
  • Persist preference
  • Apply theme globally

  Continue to work? [y]

→ Work Phase
  Branch: feature/dark-mode-toggle
  ✓ Added theme toggle component
  ✓ Created Alpine.js theme store
  ✓ Updated root HTML with data-theme binding
  Tests passing.

  Ready for review? [y]

→ Review Phase
  code-simplicity-reviewer: ✓ Clean
  architecture-strategist: ✓ Follows DaisyUI patterns
  security-sentinel: ✓ No issues
  performance-oracle: ✓ No issues

  Merge and compound? [y]

→ Compound Phase
  ✓ Merged to main
  ✓ Issue #15 closed
  ✓ Changelog updated

  Learnings:
  • DaisyUI theme switching is simpler than custom CSS variables
  • Alpine.js $persist plugin handles localStorage automatically

✓ Feature complete
```

---

## Notes

- Requires compound-engineering plugin enabled in settings
- Creates GitHub Issues for tracking (requires `gh` CLI authenticated)
- Integrates with existing `/commit` for changelog updates
- All phases can be aborted without side effects (except created branches/issues)
- Research agent selection is automatic but can be overridden with `--skip-research`
